Staging:
  src_columns:
    customer text,
    month text,
    first_week text,
    second_week text,
    third_week text,
    fourth_week text,
    fifth_week text

ODS:

EDW:
  create_table_query:
    create table if not exists edw.f_lgc_cs_week_phase(
       date_id           varchar(20),
       distributor_code  varchar(50),
       distributor_name  varchar(100),
       month             varchar(4),
       week_num          bigint,
       value             numeric(17,2),
       ld_batch_date     varchar(20),
       ld_load_time      timestamp,
       constraint pk_f_lgc_cs_week_phase primary key(distributor_name, month,week_num )
    )distributed by (distributor_name);



  delete_edw_from_ods_query:
    delete from exists edw.f_lgc_cs_week_phase;

  insert_edw_from_ods_query:
    insert into edw.f_lgc_cs_week_phase
    select
       month             as date_id,
       null              as distributor_code,
       customer          as distributor_name,
       month             as month,
       1                 as week_num,
       first week        as plan_value,
       ld_batch_date     as ld_batch_date,
       now()             as ld_load_time
    from
        ods.r_lgc_cs_weekly_phasing
    union all
    select
       month             as date_id,
       null              as distributor_code,
       customer          as distributor_name,
       month             as month,
       2                 as week_num,
       second week       as plan_value,
       ld_batch_date     as ld_batch_date,
       now()             as ld_load_time
    from
        ods.r_lgc_cs_weekly_phasing
    union all
    select
       month             as date_id,
       null              as distributor_code,
       customer          as distributor_name,
       month             as month,
       3                 as week_num,
       third week        as plan_value,
       ld_batch_date     as ld_batch_date,
       now()             as ld_load_time
    from
        ods.r_lgc_cs_weekly_phasing
    union all
    select
       month             as date_id,
       null              as distributor_code,
       customer          as distributor_name,
       month             as month,
       4                 as week_num,
       fourth week       as plan_value,
       ld_batch_date     as ld_batch_date,
       now()             as ld_load_time
    from
        ods.r_lgc_cs_weekly_phasing
    union all
    select
       month             as date_id,
       null              as distributor_code,
       customer          as distributor_name,
       month             as month,
       5                 as week_num,
       fifth week        as plan_value,
       ld_batch_date     as ld_batch_date,
       now()             as ld_load_time
    from
        ods.r_lgc_cs_weekly_phasing ;
